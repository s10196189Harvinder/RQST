@model Volunteer
@{ Layout = null; }
<!DOCTYPE html>
<meta charset="UTF-8">
<style>
    #map {
        height: 100%;
    }

    html, body {
        height: 100%;
        margin: 0;
        padding: 0;
    }
</style>

<script src="~/lib/jquery/dist/jquery.min.js"></script>
<h1>Yo, click on the zones to assign user to zone</h1>
<div id="map">

</div>
@{
    var text = (System.IO.File.ReadAllText(@"wwwroot\subzones.geojson"));
    <script>
let map;
function initMap() {
    var json = @Html.Raw(text);
    map = new google.maps.Map(document.getElementById("map"), {
        center: { lat: 1.3562033, lng: 103.8281415 },
        zoom: 11,
    })
    map.data.addGeoJson(json);
    map.data.setStyle(function (feature) {
        var requests = feature.getProperty('requests');
        var color = 'grey';
        var weight = 0.3;
        var opacity = 0.3
        if (feature.getProperty('isColorful')) {
            color = 'red';
            weight = 2;
            opacity = 0.7
        }
        return {
            fillColor: color,
            strokeWeight: weight,
            fillOpacity: opacity
        };
    });
    map.data.addListener('click', function (event) {
        event.feature.setProperty('isColorful', true);
    });
    }
    </script>
}
<script>
var id = "@ViewBag.id";
function getZones() {
    var namelist = [];
    map.data.forEach(function (feature) {
        if (feature.getProperty('isColorful')) {
            namelist.push(feature.getProperty("Name"));
        }
    });
    var string = namelist.join();
    $.ajax({
        url: "/Admin/AsgnVolunteer?vol=" + id + "&zones=" + string,
        type: "POST",
        async: true,
    }).done(function () {
        window.location.pathname = "/Admin/ViewVol";
    })

}
</script>
<link href="~/css/asgnVolunteer.css" rel="stylesheet" />
<body>
    <form class="content-form">
        <div class="contentform">
            <div class="leftcontact">
                <div class="form-group" style="margin-bottom:0 !important">
                    <p>ID <span>*</span></p>
                    <span id="icon-case"></span>
                    <input type="text" asp-for="ID" class="inputbox" readonly />
                </div>
                <div class="form-group row">
                    <p>Name <span>*</span></p>
                    <span id="icon-case"></span>
                    <input type="text" asp-for="Name" class="inputbox" readonly />
                </div>
                <div class="form-group row">
                    <p>Contact <span>*</span></p>
                    <span id="icon-case"></span>
                    <input type="text" asp-for="Contact" class="inputbox" readonly />
                </div>
                <div class="form-group row">
                    <p>Assigned Zones <span>*</span></p>
                    <span id="icon-case"></span>
                    <input type="text" asp-for="AssignedZones" class="inputbox" readonly />
                </div>
            </div>
            <div class="rightcontact">
                <div class="form-group row">
                    <p>Postal Code <span>*</span></p>
                    <span id="icon-case"></span>
                    <input type="text" asp-for="PostalCode" class="inputbox" readonly />
                </div>
                <div class="form-group row">
                    <p>Zone ID <span>*</span></p>
                    <span id="icon-case"></span>
                    <input type="text" asp-for="ZoneID" class="inputbox" readonly />
                </div>
                <div class="form-group row">
                    <p>Region Code <span>*</span></p>
                    <span id="icon-case"></span>
                    <input type="text" asp-for="RegionCode" class="inputbox" readonly />
                </div>
            </div>
            <button onclick="getZones()" type="button" class="getZone">Assign Zone</button>
        </div>
    </form>
</body>

<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA3QoucpamS6ylPkzBSJBXmbt5ZH7Np6Jk&callback=initMap"></script>
